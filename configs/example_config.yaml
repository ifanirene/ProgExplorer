test:
  enabled: true
  topics: [1, 2, 3, 4, 5]

steps:
  string_enrichment:
    all:
      input: input/genes/FB_moi15_seq2_loading_gene_k100_top300_with_uniqueness.csv
      n_top: 300
      topics: [1, 2, 3, 4, 5]
      json_out: results/output/genes_top300.json
      csv_out: results/output/genes_overview.csv
      species: 10090
      out_csv_full: results/output/string_enrichment/string_enrichment_full.csv
      out_csv_filtered: results/output/string_enrichment/string_enrichment_filtered_process_kegg.csv
      figures_dir: results/output/string_enrichment/enrichment_figures
      sleep: 0.6
      retries: 3

  literature_fetch:
    input: input/genes/FB_moi15_seq2_loading_gene_k100_top300_with_uniqueness.csv
    csv_out: results/output/ncbi_context.csv
    json_out: results/output/ncbi_context.json
    gene_summary_source: harmonizome
    context: '(endothelial OR endothelium OR "vascular endothelial")'
    top_driver: 20
    top_member: 100
    topics: [1, 2, 3, 4, 5]
    regulator_file: input/regulators/sceptre_discovery_analysis_results.csv

  batch_prepare:
    gene_file: input/genes/FB_moi15_seq2_loading_gene_k100_top300_with_uniqueness.csv
    enrichment_file: input/enrichment/string_enrichment_filtered_process_kegg.csv
    ncbi_file: results/output/ncbi_context.json
    regulator_file: input/regulators/sceptre_discovery_analysis_results.csv
    output_file: results/output/llm_batches/batch_request.json
    topics: [1, 2, 3, 4, 5]
    top_loading: 20
    top_unique: 10
    top_enrichment: 3
    genes_per_term: 10

  vertex_submit:
    batch_file: results/output/llm_batches/batch_request.json
    model: claude-sonnet-4-5
    bucket: gs://perturbseq/batch
    wait: false

  vertex_check:
    job_name: projects/123456789/locations/us-east5/batchPredictionJobs/000000000000000000

  parse_results:
    gcs_prefix: gs://perturbseq/batch/outputs/batch_request_YYYY-MM-DD_HHMMSS/
    markdown_dir: results/output/annotations
    summary_csv: results/output/annotations/summary.csv
    gene_loading_file: input/genes/FB_moi15_seq2_loading_gene_k100_top300_with_uniqueness.csv

  html_report:
    summary_csv: results/output/annotations/summary.csv
    annotations_dir: results/output/annotations
    enrichment_dir: input/enrichment/enrichment_figures
    volcano_csv: input/volcano/Discovery_FP_moi15_seq2_thresh10_k100_default.csv
    gene_loading_csv: input/genes/FB_moi15_seq2_loading_gene_k100_top300_with_uniqueness.csv
    output_html: results/output/annotations/report.html
